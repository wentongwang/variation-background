(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26f53971"],{1619:function(t,e,n){"use strict";n("4de4");var i=n("2b0e");i["default"].filter("filterAmount",(function(t,e){return e||(e=20),t&&t.length>e&&(t=t.substring(0,e)+"..."),t}))},3182:function(t,e,n){},4692:function(t,e,n){},"4f4a":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Nav"),n("el-main",[n("div",{attrs:{id:"spage-tbshare-container"}},[n("div",{staticClass:"tbshare_popup_enter"},[t._v("过滤选项")]),n("div",{staticClass:"tbshare_popup_main clearfix"},[n("el-card",{staticClass:"box-card"},[n("el-divider",{attrs:{"content-position":"left"}},[t._v("功能类型")]),n("el-row",{staticClass:"checkbox-container",attrs:{type:"flex",justify:"start"}},[n("el-checkbox-group",{on:{change:t.handleCheckedOptionsChangeOne},model:{value:t.checkboxGroup1,callback:function(e){t.checkboxGroup1=e},expression:"checkboxGroup1"}},t._l(t.options,(function(e){return n("el-checkbox-button",{key:e.name,attrs:{label:e.name}},[t._v(t._s(e.name)+" "),n("el-tag",{staticClass:"num-tag"},[t._v(t._s(e.num)+" ")])],1)})),1)],1),n("el-divider",{attrs:{"content-position":"left"}},[t._v("SNV/Indel/SV")]),n("el-row",{staticClass:"checkbox-container",attrs:{type:"flex",align:"end"}},[n("el-checkbox-group",{on:{change:t.handleCheckedOptionsChangeThree},model:{value:t.checkboxGroup3,callback:function(e){t.checkboxGroup3=e},expression:"checkboxGroup3"}},t._l(t.options3,(function(e,i){return n("el-checkbox-button",{key:i,attrs:{label:e.name}},[t._v(t._s(e.name)+" "),n("el-tag",{staticClass:"num-tag"},[t._v(t._s(e.num)+" ")])],1)})),1)],1)],1)],1)]),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"main-container"},[n("el-row",{attrs:{type:"flex",justify:"space-between"}},[n("el-col",{attrs:{span:6}},[n("p",{staticClass:"title"},[t._v(" "+t._s(t.gene.start)+"-"+t._s(t.gene.end)),n("span",{staticClass:"sub-title"})])]),n("el-col",{staticClass:"tools",attrs:{span:10}},[n("el-col",{attrs:{span:10}},[n("div",{staticClass:"tools-1"},[n("p",[t._v(t._s(t.$t("gene.zoom")))]),n("p",{staticClass:"svg-container",on:{click:function(e){return t.zoomClick("10")}}},[n("svg-icon",{attrs:{"icon-class":"narrow"}}),n("span",[t._v("-10x")])],1),n("p",{staticClass:"svg-container",on:{click:function(e){return t.zoomClick("3")}}},[n("svg-icon",{attrs:{"icon-class":"narrow"}}),n("span",[t._v("-3x")])],1),n("p",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"enlarge"},on:{click:function(e){return t.zoomClick("0.3333")}}}),n("span",[t._v("+3x")])],1),n("p",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"enlarge"},on:{click:function(e){return t.zoomClick("0.1")}}}),n("span",[t._v("+10x")])],1)])]),n("el-col",{attrs:{span:14}},[n("div",{staticClass:"tools-2"},[n("p",[t._v(t._s(t.$t("gene.move")))]),n("p",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"Left-3"},on:{click:function(e){return t.moveClick("-95")}}}),n("span",[t._v("-95%")])],1),n("p",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"Left-2"},on:{click:function(e){return t.moveClick("-50")}}}),n("span",[t._v("-50%")])],1),n("p",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"Left-1"},on:{click:function(e){return t.moveClick("-5")}}}),n("span",[t._v("-5%")])],1),n("p",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"Right-1"},on:{click:function(e){return t.moveClick("5")}}}),n("span",[t._v("+5%")])],1),n("p",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"Right-2"},on:{click:function(e){return t.moveClick("50")}}}),n("span",[t._v("+50%")])],1),n("p",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"Right-3"},on:{click:function(e){return t.moveClick("95")}}}),n("span",[t._v("+95%")])],1)])])],1)],1),n("el-divider"),n("div",{staticClass:"axis-container"},[n("svg")]),n("div",{staticClass:"annotation-container"},[n("svg",{directives:[{name:"drag",rawName:"v-drag"}],attrs:{id:"svg-drag"}})]),n("div",{staticClass:"variation-container",on:{click:function(e){return t.variationClick(e)}}}),[n("el-row",[n("el-col",{attrs:{span:8}},[n("el-button",{staticClass:"resetBtn",attrs:{type:"primary"},on:{click:t.onReset}},[t._v("初始化")]),n("div",{attrs:{id:"mapChart"}})],1),n("el-col",{attrs:{span:16}},[n("VirtualScroll",{key:t.virtualListValue,ref:"virtualScroll",attrs:{virtualized:!0,data:t.tableData,"key-prop":"variatiId"},on:{change:function(e){return t.virtualList=e}}},[n("el-table",{ref:"filterTable",staticClass:"gene-table",staticStyle:{width:"100%"},attrs:{"row-key":"variatiId",size:"mini",data:t.virtualList,height:"540","row-style":t.TableRowStyle,"highlight-current-row":""},on:{"cell-click":t.tableCell}},[n("el-table-column",{attrs:{prop:"variatiId",label:t.$t("gene.table.variatiId"),width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return["SV"===e.row.variation_type?n("el-link",{attrs:{href:"#/svVariant?id="+e.row.variatiId+"&chrom="+e.row.chrom,type:"primary"}},[t._v(t._s(t._f("filterAmount")(e.row.variatiId,22)))]):n("el-link",{attrs:{href:"#/variant?id="+e.row.variatiId+"&chrom="+e.row.chrom,type:"primary"}},[t._v(t._s(t._f("filterAmount")(e.row.variatiId,22)))])]}}])}),n("el-table-column",{attrs:{prop:"gene",label:t.$t("gene.table.gene")}}),n("el-table-column",{attrs:{prop:"rsid",label:t.$t("gene.table.rsid"),width:"100"}}),n("el-table-column",{attrs:{prop:"chn100k_ALL",label:t.$t("gene.table.chn100k_ALL")}}),n("el-table-column",{attrs:{prop:"exonicFunc",label:t.$t("gene.table.exonicFunc")},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-badge",{staticClass:"mark",staticStyle:{"margin-top":"15px","margin-right":"5px"},attrs:{"is-dot":"",type:"danger"===e.row.exonicFunColor?"danger":"success"===e.row.exonicFunColor?"success":"info"}}),t._v(t._s(e.row.exonicFuncValue)+" ")]}}])}),n("el-table-column",{attrs:{prop:"variation_type",label:t.$t("gene.table.variation_type"),width:"70"}}),n("el-table-column",{attrs:{prop:"geneDetail",label:t.$t("gene.table.geneDetail"),"show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("filterAmount")(e.row.geneDetail,100))+" ")]}}])})],1)],1)],1)],1)]],2)])],1)},a=[],r=n("5530"),o=(n("159b"),n("4e82"),n("b680"),n("ac1f"),n("1276"),n("b0c0"),n("d3b7"),n("25f0"),n("2f62")),s=n("9ce4"),c=n("5698"),l=n("ca75"),u=n("313e"),f=n("03d6b"),d=n("6bf2");n("1619");n("817d");var h={name:"Gene",components:{Nav:l["a"],VirtualScroll:d["a"]},directives:{drag:{bind:function(t,e,n){var i=0,a=0,r=!1;t.onmousedown=function(e){i=e.clientX,r=!0,a=0,t.style.cursor="move"},window.onmousemove=function(e){if(0!=r){var n=e.clientX;a=n-i,t.style.left=a+"px"}},t.onmouseup=function(){a<-20&&a>-300?(n.context.moveClick("10"),t.style.cursor="default"):a<-300&&(n.context.moveClick("50"),t.style.cursor="default"),a>300?(n.context.moveClick("-50"),t.style.cursor="default"):a>20&&a<300&&(n.context.moveClick("-10"),t.style.cursor="default"),r=!1,t.style.left="0px",t.style.cursor="default"}}}},data:function(){return{virtualList:[],virtualListValue:void 0,geneData:{genomic:[{chrom:"",source:"",type:"",start:0,end:0,score:"",chain:"",cds_position:"",gene_id:"",parent:"",gene:"",id:1}],variation:[]},filterData:"",loading:!0,radio1:!1,containerWidth:0,minIdxSC:0,svg:"",svg2:"",input:"",checkboxGroup1:["pLoF","Missense","Synonymous","Other"],checkboxGroup3:["SNVs","Indels","SVs"],options:[{name:"pLoF",num:0},{name:"Missense",num:0},{name:"Synonymous",num:0},{name:"Other",num:0}],options2:[{name:"EXomes",num:0},{name:"Genomes",num:0}],options3:[{name:"SNVs",num:0},{name:"Indels",num:0},{name:"SVs",num:0}],tableData:[],colorActive:["rgb(245, 108, 108)","rgb(230, 162, 60)","rgb(103, 194, 58)","rgb(157, 157, 157)"],color:["rgb(253, 226, 226)","rgb(250, 236, 216)","rgb(208, 249, 188)","rgb(233, 233, 235)"],tableBgPos:"",dataList:[]}},computed:Object(r["a"])(Object(r["a"])({},Object(o["b"])(["gene"])),{},{variation:function(){return this.filterData.variation}}),watch:{filterData:function(){var t=this;this.$nextTick((function(){var e=t.containerWidth/20*1.5,n=t.containerWidth-2*e,i=t.gene.start-100<0?0:t.gene.start-100,a=t.gene.end+100,r=[i,a],o=a-i;function s(){var r=100,o=c["k"](".axis-container").select("svg");o.selectAll("*").remove(),o.attr("class","axis").attr("width",t.containerWidth).attr("height",r);var s=c["i"]().domain([i,a]).range([0,n]),l=c["a"]().scale(s).ticks(10).tickPadding(10);o.append("text").attr("x",0).attr("y",50).attr("fill","#409EFF").attr("font-size",20).text((function(){return"chr"+(23===t.gene.chrom?"X":t.gene.chrom)})),o.append("g").attr("transform",(function(){return"translate("+e+",50)"})).call(l)}function l(e,n){var a=t.containerWidth/20*1.5,r=t.containerWidth-2*a,s=[],u=[],f=0,d=0,h=[],g=null,p=null,m=0;t.svg=c["k"](".annotation-container").select("svg"),t.svg.selectAll("*").remove(),t.svg.style("overflow","visible"),t.annotationColor="#424242",t.filterData.genomic.forEach((function(t){"pseudogene"!==t["type"]&&"gene"!==t["type"]||s.push({start:(t["start"]-i)/o*r,end:(t["end"]-i)/o*r,gene:t["gene"]})})),s.sort((function(t,e){return t["start"]-e["start"]})),s.forEach((function(t,e){f=0,d=-1/0;for(var n=e;n<s.length;n++)f=s[n]["start"],f-d>120&&-1===h.indexOf(s[n]["gene"])&&(d=s[n]["end"],h.push(s[n]["gene"]),u.push(s[n]))})),u.forEach((function(a,s){s>0&&u[s]["start"]-120<u[s-1]["end"]&&(m+=1),g=null,p=null,t.filterData.genomic.forEach((function(n){"."===n["parent"]&&n["gene"]===a["gene"]&&("pseudogene"!==n["type"]&&"gene"!==n["type"]||(g=n["gene_id"],t.svg.append("line").attr("x1",(n["start"]-i)/o*r).attr("y1",13+15*m).attr("x2",(n["end"]-i)/o*r).attr("y2",13+15*m).attr("stroke","#dbdbdb").attr("stroke-width",2),t.svg.append("text").attr("x",(n["start"]-i)/o*r-10.5*n["gene"].length).attr("y",18+15*m).attr("fill","#409EFF").attr("font-size",14).attr("cursor","pointer").attr("geneId",n["gene_id"]).on("click",(function(){var t=c["k"](this).text(),n=c["k"](this).attr("geneId");e===t?l():l(t,n)})).text((function(){return n["gene"]})))),n["parent"]===g&&(p=n["gene_id"]),n["parent"]===p&&("CDS"===n["type"]&&t.svg.append("rect").attr("x",(n["start"]-i)/o*r).attr("y",6+15*m).attr("width",(n["end"]-n["start"])/o*r).attr("height",14).attr("fill","#424242"),"exon"===n["type"]&&t.svg.append("rect").attr("x",(n["start"]-i)/o*r).attr("y",10+15*m).attr("width",(n["end"]-n["start"])/o*r).attr("height",5).attr("fill","#424242").attr("class","UTR"))})),a["gene"]===e&&t.filterData.genomic.forEach((function(e){e["parent"]===n&&(m+=1,p=e["gene_id"],t.svg.append("line").attr("x1",(e["start"]-i)/o*r).attr("y1",13+15*m).attr("x2",(e["end"]-i)/o*r).attr("y2",13+15*m).attr("stroke","#c7def5").attr("stroke-width",2),t.svg.append("text").attr("x",(e["start"]-i)/o*r-8*e["gene_id"].length).attr("y",18+15*m).attr("fill","#409EFF").attr("font-size",12).attr("geneId",e["gene_id"]).text((function(){return e["gene_id"]}))),e["parent"]===p&&("CDS"===e["type"]&&t.svg.append("rect").attr("x",(e["start"]-i)/o*r).attr("y",6+15*m).attr("width",(e["end"]-e["start"])/o*r).attr("height",14).attr("fill","#81bcf9"),"exon"===e["type"]&&t.svg.append("rect").attr("x",(e["start"]-i)/o*r).attr("y",10+15*m).attr("width",(e["end"]-e["start"])/o*r).attr("height",5).attr("fill","#81bcf9").attr("class","UTR"))}))}));var v=16*(m+1);t.svg.attr("height",v).attr("width",r)}s(r),l()}))},variation:function(){var t=this,e=t.gene.start-100<0?0:t.gene.start-100,n=t.gene.end+100,i=n-e;function a(){var n,a,r,o=t.containerWidth/20*1.5,s=t.containerWidth-2*o,l=100;c["k"](".variation-container").selectAll("*").remove();var u=c["k"](".variation-container").append("svg").attr("width",s).attr("height",l);t.filterData.variation.forEach((function(o,c){r=(o["start"]+parseInt(o["end"]-o["start"]+3)/2-e)/i*s,-1!==o["func"].indexOf("ncRNA_exonic")||-1!==o["func"].indexOf("ncRNA_intronic")||-1!==o["func"].indexOf("intronic")||-1!==o["func"].indexOf("UTR5")||-1!==o["func"].indexOf("UTR3")||-1!==o["func"].indexOf("ncRNA_splicing")||-1!==o["func"].indexOf("UTR5;UTR3")||-1!==o["func"].indexOf("ncRNA_exonic;splicing")||-1!==o["func"].indexOf("ncRNA_UTR5")?(n=t.color[2],a=t.colorActive[2]):-1!==o["func"].indexOf("exonic")||-1!==o["func"].indexOf("splicing")||-1!==o["func"].indexOf("exonic;splicing")?(n=t.color[0],a=t.colorActive[0]):(n=t.color[3],a=t.colorActive[3]),"."!==o["chn100k_ALL"]&&(c<11?u.append("ellipse").attr("cx",r).attr("cy",50).attr("rx",parseInt(o["end"]-o["start"]+5)).attr("ry",parseInt(35*o["chn100k_ALL"])).attr("stroke","#DCDFE6").attr("fill",a):u.append("ellipse").attr("cx",r).attr("cy",50).attr("rx",parseInt(o["end"]-o["start"]+5)).attr("ry",parseInt(35*o["chn100k_ALL"])).attr("stroke","#C0C4CC").attr("fill",n))}))}function r(){t.tableData=[];var e=0,n=0,i=0,a=0,r=0,o=0,s=0,c=0,l=0;t.filterData.variation.forEach((function(u){var f="",d="";f=-1!==u["func"].indexOf("ncRNA_exonic")||-1!==u["func"].indexOf("ncRNA_intronic")||-1!==u["func"].indexOf("intronic")||-1!==u["func"].indexOf("UTR5")||-1!==u["func"].indexOf("UTR3")||-1!==u["func"].indexOf("ncRNA_splicing")||-1!==u["func"].indexOf("UTR5;UTR3")||-1!==u["func"].indexOf("ncRNA_exonic;splicing")||-1!==u["func"].indexOf("ncRNA_UTR5")?"success":-1!==u["func"].indexOf("exonic")||-1!==u["func"].indexOf("splicing")||-1!==u["func"].indexOf("exonic;splicing")?"danger":"info",d=-1!==u["exonicFunc"].indexOf(".")?u["func"]:u["func"]+":"+u["exonicFunc"],"splicing"===u["func"]||"exonic;splicing"===u["func"]||"stopgain"===u["exonicFunc"]||"frameshift insertion"===u["exonicFunc"]||"frameshift deletion"===u["exonicFunc"]||"startloss"===u["exonicFunc"]||"stoploss"===u["exonicFunc"]?e+=1:"nonsynonymous SNV"===u["exonicFunc"]||"nonframeshift deletion"===u["exonicFunc"]||"nonframeshift insertion"===u["exonicFunc"]?n+=1:"synonymous SNV"===u["exonicFunc"]||"unknown"===u["exonicFunc"]?i+=1:"splicing"!==u["func"]&&"exonic;splicing"!==u["func"]&&"exonic"!==u["func"]&&(a+=1),-1!==u["variation_type"].indexOf("exome")&&(r+=1),-1!==u["variation_type"].indexOf("genome")&&(o+=1),-1!==u["variation_type"].indexOf("SNV")&&(s+=1),-1!==u["variation_type"].indexOf("INDEL")&&(c+=1),-1!==u["variation_type"].indexOf("SV")&&(l+=1),t.tableData.push({variatiId:u["uu_id"],chrom:u["chrom"],rsid:u["rsid"],exonicFunColor:f,exonicFuncValue:d,variation_type:u["variation_type"],dbsnp:u["af"],chn100k_ALL:parseFloat(100*u["chn100k_ALL"]).toFixed(4)+"%",gene:u["gene"],geneDetail:u["geneDetail"],chn100k_NE:u["chn100k_NE"],chn100k_N:u["chn100k_N"],chn100k_E:u["chn100k_E"],chn100k_C:u["chn100k_C"],chn100k_NW:u["chn100k_NW"],chn100k_SW:u["chn100k_SW"],chn100k_S:u["chn100k_S"]})})),t.options=[{name:"pLoF",num:e},{name:"Missense",num:n},{name:"Synonymous",num:i},{name:"Other",num:a}],t.options2=[{name:"EXomes",num:r},{name:"Genomes",num:o}],t.options3=[{name:"SNVs",num:s},{name:"Indels",num:c},{name:"SVs",num:l}]}a(),r()},input:function(){this.dataFiter()}},created:function(){var t=this;if(this.gene.value){var e={start:this.gene.start,end:this.gene.end,chrom:"x"===this.gene.chrom?23:this.gene.chrom};Object(s["a"])(e).then((function(e){t.geneData=e,t.filterData=Object.assign({},e),t.containerWidth=parseInt(c["k"](".axis-container").style("width")),t.loading=!1}))}},mounted:function(){var t=this;if(this.$refs.filterTable){this.dom=this.$refs.filterTable.bodyWrapper,this.dom.addEventListener("scroll",(function(){var e,n,i,a=t.dom.clientHeight,r=t.dom.scrollHeight,o=r-a,s=t.dom.scrollTop,l=t.gene.start-100<0?0:t.gene.start-100,u=t.gene.end+100,f=u-l,d=t.containerWidth/20*1.5,h=t.containerWidth-2*d,g=c["k"](".variation-container").select("svg");g.selectAll("*").remove(),t.minIdxSC=Math.ceil(s*(t.filterData.variation.length-1)/o),t.minIdxSC<5?t.minIdxSC=5:t.minIdxSC>t.filterData.variation.length-6&&(t.minIdxSC=t.filterData.variation.length-5),t.filterData.variation.forEach((function(a,r){-1!==a["func"].indexOf("ncRNA_exonic")||-1!==a["func"].indexOf("ncRNA_intronic")||-1!==a["func"].indexOf("intronic")||-1!==a["func"].indexOf("UTR5")||-1!==a["func"].indexOf("UTR3")||-1!==a["func"].indexOf("ncRNA_splicing")||-1!==a["func"].indexOf("UTR5;UTR3")||-1!==a["func"].indexOf("ncRNA_exonic;splicing")||-1!==a["func"].indexOf("ncRNA_UTR5")?(n=t.color[2],i=t.colorActive[2]):-1!==a["func"].indexOf("exonic")||-1!==a["func"].indexOf("splicing")||-1!==a["func"].indexOf("exonic;splicing")?(n=t.color[0],i=t.colorActive[0]):(n=t.color[3],i=t.colorActive[3]),e=(a["start"]+parseInt(a["end"]-a["start"]+3)/2-l)/f*h,"."!==a["chn100k_ALL"]&&(t.minIdxSC-r<6&&t.minIdxSC-r>-6?g.append("ellipse").attr("cx",e).attr("cy",50).attr("rx",parseInt(a["end"]-a["start"]+5)).attr("ry",parseInt(35*a["chn100k_ALL"])).attr("stroke","#DCDFE6").attr("fill",i):g.append("ellipse").attr("cx",e).attr("cy",50).attr("rx",parseInt(a["end"]-a["start"]+5)).attr("ry",parseInt(35*a["chn100k_ALL"])).attr("stroke","#C0C4CC").attr("fill",n))}))}));var e=document.getElementById("svg-drag");window.addEventListener&&e.addEventListener("DOMMouseScroll",(function(e){var n=e||window.event,i=-n.detail/3;i>=1&&t.zoomClick("3"),i<=-1&&t.zoomClick("0.3333"),e.preventDefault()}),!1),e.onmousewheel=function(e){var n=e||window.event,i=n.wheelDelta/120;return i>=1&&t.zoomClick("3"),i<=-1&&t.zoomClick("0.3333"),!1}}this.initMap(),this.initChart()},methods:{zoomClick:function(t){var e=this,n=parseInt((this.gene.end-this.gene.start)/2)+this.gene.start,i=parseInt((this.gene.end-this.gene.start)*t/2);if(i>500){var a=n-i<=0?0:n-i,r=n+i,o={start:a,end:r,chrom:"x"===this.gene.chrom?23:this.gene.chrom};Object(s["a"])(o).then((function(t){e.geneData=t,e.filterData=Object.assign({},t),e.containerWidth=parseInt(c["k"](".axis-container").style("width")),e.gene.start=o.start,e.gene.end=o.end,e.$store.dispatch("variations/geneSearch",e.gene)}))}},moveClick:function(t){var e=this,n=parseInt((this.gene.end-this.gene.start)/2),i=parseInt((this.gene.end-this.gene.start)/2+this.gene.start+parseInt(t)*n/100),a=i-n<=0?0:i-n,r=a<=0?2*n:i+n;if(this.gene.start>0||t>0){var o={start:a,end:r,chrom:this.gene.chrom};Object(s["a"])(o).then((function(t){e.geneData=t,e.filterData=Object.assign({},t),e.containerWidth=parseInt(c["k"](".axis-container").style("width")),e.gene.start=o.start,e.gene.end=o.end,e.$store.dispatch("variations/geneSearch",e.gene)}))}},filterHandler:function(t,e,n){var i=n["property"];return e[i]===t},handleCheckedOptionsChangeOne:function(t){this.dataFiter()},handleCheckedOptionsChangeTwo:function(t){this.dataFiter()},handleCheckedOptionsChangeThree:function(t){this.dataFiter()},mouseWheel:function(t){var e=t||window.event,n=null;e.wheelDelta?n=e.wheelDelta/120:e.detail&&(n=-e.detail/3),n>=1&&this.zoomClick("3"),n<=-1&&this.zoomClick("0.33333")},variationClick:function(t){var e,n,i,a=this,r=this.dom.clientHeight,o=this.dom.scrollHeight,s=o-r,l=a.gene.start-100<0?0:a.gene.start-100,u=a.gene.end+100,f=u-l,d=a.containerWidth/20*1.5,h=a.containerWidth-2*d,g=1/0,p=0,m=c["k"](".variation-container").select("svg");m.selectAll("*").remove(),this.filterData.variation.forEach((function(n,i){e=(n["start"]+parseInt(n["end"]-n["start"]+5)/2-l)/f*h,Math.abs(t.x-d-20-e)<g&&(g=Math.abs(t.x-d-20-e),a.minIdxSC=i,a.minIdxSC<5?(p=0,a.minIdxSC=5):a.minIdxSC>a.filterData.variation.length-6?(p=a.filterData.variation.length-1,a.minIdxSC=a.filterData.variation.length-5):p=a.minIdxSC)})),this.filterData.variation.forEach((function(t,r){e=(t["start"]+parseInt(t["end"]-t["start"]+5)/2-l/f)*h,-1!==t["func"].indexOf("ncRNA_exonic")||-1!==t["func"].indexOf("ncRNA_intronic")||-1!==t["func"].indexOf("intronic")||-1!==t["func"].indexOf("UTR5")||-1!==t["func"].indexOf("UTR3")||-1!==t["func"].indexOf("ncRNA_splicing")||-1!==t["func"].indexOf("UTR5;UTR3")||-1!==t["func"].indexOf("ncRNA_exonic;splicing")||-1!==t["func"].indexOf("ncRNA_UTR5")?(n=a.color[2],i=a.colorActive[2]):-1!==t["func"].indexOf("exonic")||-1!==t["func"].indexOf("splicing")||-1!==t["func"].indexOf("exonic;splicing")?(n=a.color[0],i=a.colorActive[0]):(n=a.color[3],i=a.colorActive[3]),"."!==t["chn100k_ALL"]&&(a.minIdxSC-r<6&&a.minIdxSC-r>-6?m.append("ellipse").attr("cx",e).attr("cy",50).attr("rx",parseInt(t["end"]-t["start"]+5)).attr("ry",parseInt(35*t["chn100k_ALL"])).attr("stroke","#DCDFE6").attr("fill",i):m.append("ellipse").attr("cx",e).attr("cy",50).attr("rx",parseInt(t["end"]-t["start"]+5)).attr("ry",parseInt(35*t["chn100k_ALL"])).attr("stroke","#C0C4CC").attr("fill",n))})),this.dom.scrollTop=s*p/(this.filterData.variation.length-1)},geneListClick:function(t,e){if("gene"===this.geneList[e].type||"pseudogene"===this.geneList[e].type){var n=this.$router.resolve({name:"Gene"});this.$store.dispatch("variations/geneSearch",{chrom:parseInt(this.geneList[e].chrom.split(".")[0].split("_")[1]),value:this.geneList[e].gene,label:this.geneList[e].gene,type:this.geneList[e].type,start:parseInt(this.geneList[e].start)-1,end:parseInt(this.geneList[e].end)+1}),window.open(n.href,"_blank")}},dataFiter:function(){var t,e=this,n=[];e.filterData.variation=[],this.input?e.geneData.variation.forEach((function(i){if(-1!==i["uuId"].indexOf(e.input)){t=0;while(t<e.checkboxGroup1.length)("pLoF"!==e.checkboxGroup1[t]||"splicing"!==i["func"]&&"exonic;splicing"!==i["func"]&&"stopgain"!==i["exonicFunc"]&&"frameshift insertion"!==i["exonicFunc"]&&"frameshift deletion"!==i["exonicFunc"]&&"startloss"!==i["exonicFunc"]&&"stoploss"!==i["exonicFunc"])&&("Missense"!==e.checkboxGroup1[t]||"splicing"===i["func"]||"exonic;splicing"===i["func"]||"nonsynonymous SNV"!==i["exonicFunc"]&&"nonframeshift deletion"!==i["exonicFunc"]&&"nonframeshift insertion"!==i["exonicFunc"])&&("Synonymous"!==e.checkboxGroup1[t]||"splicing"===i["func"]||"exonic;splicing"===i["func"]||"synonymous SNV"!==i["exonicFunc"]&&"unknown"!==i["exonicFunc"])?"Other"===e.checkboxGroup1[t]&&"splicing"!==i["func"]&&"exonic;splicing"!==i["func"]&&"exonic"!==i["func"]&&n.push(i):n.push(i),t++}})):e.geneData.variation.forEach((function(i){t=0;while(t<e.checkboxGroup1.length)("pLoF"!==e.checkboxGroup1[t]||"splicing"!==i["func"]&&"exonic;splicing"!==i["func"]&&"stopgain"!==i["exonicFunc"]&&"frameshift insertion"!==i["exonicFunc"]&&"frameshift deletion"!==i["exonicFunc"]&&"startloss"!==i["exonicFunc"]&&"stoploss"!==i["exonicFunc"])&&("Missense"!==e.checkboxGroup1[t]||"splicing"===i["func"]||"exonic;splicing"===i["func"]||"nonsynonymous SNV"!==i["exonicFunc"]&&"nonframeshift deletion"!==i["exonicFunc"]&&"nonframeshift insertion"!==i["exonicFunc"])&&("Synonymous"!==e.checkboxGroup1[t]||"splicing"===i["func"]||"exonic;splicing"===i["func"]||"synonymous SNV"!==i["exonicFunc"]&&"unknown"!==i["exonicFunc"])?"Other"===e.checkboxGroup1[t]&&"splicing"!==i["func"]&&"exonic;splicing"!==i["func"]&&"exonic"!==i["func"]&&n.push(i):n.push(i),t++})),n.forEach((function(t){for(var n=0;n<e.checkboxGroup3.length;n++)"SNVs"===e.checkboxGroup3[n]&&-1!==t["variation_type"].indexOf("SNV")&&e.filterData.variation.push(t),"Indels"===e.checkboxGroup3[n]&&-1!==t["variation_type"].indexOf("INDEL")&&e.filterData.variation.push(t),"SVs"===e.checkboxGroup3[n]&&-1!==t["variation_type"].indexOf("SV")&&e.filterData.variation.push(t)}))},mergeProvinces:function(t,e,n){for(var i=t.features,a=[],r=[],o=0;o<e.length;o++){for(var s=[],c=[],l=0;l<e[o].length;l++)for(var u=0;u<i.length;u++)if(i[u].properties.name==e[o][l]){if(i[u].geometry.coordinates[0].constructor==String)for(var f=0;f<i[u].geometry.coordinates.length;f++)s.push(i[u].geometry.coordinates[f]);else if(i[u].geometry.coordinates[0].constructor==Array)for(var d=0;d<i[u].geometry.coordinates.length;d++)for(var h=0;h<i[u].geometry.coordinates[d].length;h++)s.push(i[u].geometry.coordinates[d][h]);if(i[u].geometry.encodeOffsets[0].constructor==String)c.push(i[u].geometry.encodeOffsets);else if(i[u].geometry.encodeOffsets[0].constructor==Array)for(d=0;d<i[u].geometry.encodeOffsets.length;d++)if(i[u].geometry.encodeOffsets[d][0].constructor==Array)for(var g=0;g<i[u].geometry.encodeOffsets[d].length;g++)c.push(i[u].geometry.encodeOffsets[d][g]);else c.push(i[u].geometry.encodeOffsets[d]);break}a.push(s),r.push(c)}i=[];for(var p=0;p<e.length;p++){var m={id:i.length.toString(),type:"FeatureCollection",geometry:{type:"Polygon",coordinates:a[p],encodeOffsets:r[p]},properties:{name:n.name[p]||"",childNum:a[p].length}};n.cp[p]&&(m.properties.cp=n.cp[p]),i.push(m)}t.features=i},initMap:function(){var t={names:[["北京","天津","河北","山西","内蒙古"],["黑龙江","吉林","辽宁"],["山东","江苏","安徽","江西","浙江","福建","上海","台湾"],["河南","湖北","湖南"],["广东","广西","海南","香港","澳门"],["重庆","四川","云南","西藏","贵州"],["陕西","甘肃","青海","宁夏","新疆"]],properties:{name:["华北","东北","华东","华中","华南","西南","西北"],cp:[[116.24,39.54],[126.32,43.5],[121.28,31.13],[114.2,30.32],[113.15,23.08],[104.04,30.39],[103.49,36.03]]}};f.features&&f.features.length>8&&this.mergeProvinces(f,t.names,t.properties),u["registerMap"]("china",f)},initChart:function(t){var e=this,n=document.getElementById("mapChart"),i=document.body.clientWidth;n.style.height=540/1903*i+"px";var a=u["init"](n),r={tooltip:{trigger:"item",formatter:function(t){return t.name}},visualMap:{type:"piecewise",left:"left",top:"top",splitNumber:4,pieces:[{min:.05,max:1,label:"5%-100%",color:"#f96262"},{min:.01,max:.05,label:"1%-5%",color:"#f5c63a"},{min:.005,max:.01,label:"0.5%-1%",color:"#48bd48"},{min:0,max:.005,label:"0%-0.5%",color:"#40a1e5"},{value:0,label:"0%",color:"#eeeeee"}],show:!0},geo:{map:"china",roam:!1,center:[105,35],zoom:1,label:{normal:{show:!0,fontSize:"12",color:"rgba(0,0,0,0.7)"},emphasis:{textStyle:{color:"#fff"}}},itemStyle:{normal:{borderColor:"rgba(0, 0, 0, 0.2)"},emphasis:{areaColor:"#F3B329",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:20,borderWidth:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},series:[{name:"变异数量",type:"map",geoIndex:0,data:t}]};a.setOption(r,!0),a.on("click",(function(t){"东北"===t.name&&(e.tableBgPos="chn100k_NE",e.dataList=[{name:"东北",value:.004}]),"华北"===t.name&&(e.tableBgPos="chn100k_N",e.dataList=[{name:"华北",value:.004}]),"华东"===t.name&&(e.tableBgPos="chn100k_E",e.dataList=[{name:"华东",value:.004}]),"华中"===t.name&&(e.tableBgPos="chn100k_C",e.dataList=[{name:"华中",value:.004}]),"华南"===t.name&&(e.tableBgPos="chn100k_S",e.dataList=[{name:"华南",value:.004}]),"西北"===t.name&&(e.tableBgPos="chn100k_NW",e.dataList=[{name:"西北",value:.004}]),"西南"===t.name&&(e.tableBgPos="chn100k_SW",e.dataList=[{name:"西南",value:.004}]),a.clear(),a.off(),e.initChart(e.dataList),e.$refs.filterTable.setCurrentRow()})),this.$nextTick((function(){a.resize()}))},tableCell:function(t,e,n,i){this.dataList=[{name:"东北",value:t.chn100k_NE},{name:"华北",value:t.chn100k_N},{name:"华南",value:t.chn100k_S},{name:"华东",value:t.chn100k_E},{name:"华中",value:t.chn100k_C},{name:"西南",value:t.chn100k_SW},{name:"西北",value:t.chn100k_NW}],""!==this.tableBgPos&&(this.tableBgPos=""),this.initChart(this.dataList)},TableRowStyle:function(t){var e={};return this.tableBgPos&&(0<t.row[this.tableBgPos]&&t.row[this.tableBgPos]<.005&&(e.background="rgba(123,189,235,"+1e3*t.row[this.tableBgPos]+")"),.005<=t.row[this.tableBgPos]&&t.row[this.tableBgPos]<.01&&(e.background="rgba(111,215,111,"+1e3*t.row[this.tableBgPos]+")"),.01<=t.row[this.tableBgPos]&&t.row[this.tableBgPos]<.05&&(e.background="rgba(245,198,58,"+1e3*t.row[this.tableBgPos]+")"),.05<=t.row[this.tableBgPos]&&t.row[this.tableBgPos]<1&&(e.background="rgba(245,138,138,"+1e3*t.row[this.tableBgPos]+")")),e},onReset:function(){""!==this.tableBgPos&&(this.tableBgPos=""),this.dataList.length>0&&(this.dataList=[],this.$refs.filterTable.setCurrentRow(),this.initChart(this.dataList))}}},g=h,p=(n("f256"),n("d510"),n("2877")),m=Object(p["a"])(g,i,a,!1,null,"a1d56a96",null);e["default"]=m.exports},d510:function(t,e,n){"use strict";n("4692")},f256:function(t,e,n){"use strict";n("3182")}}]);